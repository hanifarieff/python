scheduler tanggal : 2025-03-10 02:50:02.139604
      PatientID  AdmissionID  ... StayInd StayIndAdmission
0         15641         1320  ...       n                n
1         46352         1447  ...       n                n
2         51326          164  ...       n                n
3         53154         1013  ...       n                n
4         60576           10  ...       n                n
...         ...          ...  ...     ...              ...
2398    2291418            1  ...       n                y
2399    2291419            1  ...       n                y
2400    2291420            1  ...       y                y
2401    2291421            1  ...       n                y
2402    2291422            1  ...       n                y

[2403 rows x 6 columns]
     PatientID  AdmissionID  ... StayInd StayIndAdmission
0        46670           75  ...       y                y
1        50973          180  ...       y                y
2        60576           10  ...       n                n
3        71284            3  ...       y                y
4       421316           10  ...       y                y
..         ...          ...  ...     ...              ...
429    2291418            1  ...       n                y
430    2291419            1  ...       n                y
431    2291420            1  ...       n                y
432    2291421            1  ...       n                y
433    2291422            1  ...       n                y

[434 rows x 6 columns]
     PatientID  AdmissionID  ... StayInd StayIndAdmission
0        46670           75  ...       y                y
1        50973          180  ...       y                y
2        60576           10  ...       n                n
3        71284            3  ...       y                y
4       110730           36  ...       y                y
..         ...          ...  ...     ...              ...
727    2291418            1  ...       n                y
728    2291419            1  ...       n                y
729    2291420            1  ...       n                y
730    2291421            1  ...       n                y
731    2291422            1  ...       n                y

[732 rows x 6 columns]
after filter
      PatientID  AdmissionID  MedicalNo  ... StayInd StayIndAdmission Flag
0         15641         1320  334-01-37  ...       n                n    1
1         46352         1447  329-62-58  ...       n                n    1
2         51326          164  107-01-26  ...       n                n    1
3         53154         1013  308-42-00  ...       n                n    1
4         60576           10  333-91-85  ...       n                n    1
...         ...          ...        ...  ...     ...              ...  ...
3478    2289409            1  484-05-61  ...       n                y    1
3479    2289410            1  484-05-62  ...       n                y    1
3482    2289414            1  484-05-65  ...       n                n    1
3483    2289415            1  484-05-66  ...       n                n    1
3484    2289416            1  484-05-67  ...       n                n    1

[2806 rows x 7 columns]
cek target
       PatientID  AdmissionID       MedicalNo  ... StayInd StayIndAdmission Flag
0          15641          430       334-01-37  ...       n             None    1
1          15641          435       334-01-37  ...       n             None    1
2          15641          445       334-01-37  ...       n             None    1
3          15641          456       334-01-37  ...       n             None    1
4          15641          459       334-01-37  ...       n             None    1
...          ...          ...             ...  ...     ...              ...  ...
33432    2290639            1       484-06-09  ...       n                y    1
33433    2290640            1       484-06-10  ...       n                y    1
33434    2290641            1       484-06-11  ...       n                y    1
33435    2290642            1  PK250308-00-16  ...       n                n    1
33436    2290644            1       484-06-13  ...       n                y    1

[33437 rows x 7 columns]
ini mismatch
    PatientID  AdmissionID  MedicalNo  ... StayInd StayIndAdmission Flag
0     1109851          770  422-33-09  ...       y                y    1
1     1168428          125  427-65-10  ...       y                y    1
2     1231325          467  435-14-32  ...       y                y    1
3     1431457           21  452-21-01  ...       y                y    1
4     1639935           34  469-03-56  ...       y                y    1
5     1980944           18  478-13-57  ...       y                y    1
6     2096382           11  480-75-89  ...       y                y    1
7     2131634           23  481-36-04  ...       y                y    1
8     2256883            2  483-94-31  ...       y                y    1
9     2279898            1  484-02-37  ...       y                y    1
10    2283649            1  484-03-77  ...       y                y    1
11    2285669            2  485-05-81  ...       y                y    1

[12 rows x 7 columns]
ini source setelah di filter yang n != y
      PatientID  AdmissionID  MedicalNo  ... StayInd StayIndAdmission Flag
0         15641         1320  334-01-37  ...       n                n    1
1         46352         1447  329-62-58  ...       n                n    1
2         51326          164  107-01-26  ...       n                n    1
3         53154         1013  308-42-00  ...       n                n    1
4         60576           10  333-91-85  ...       n                n    1
...         ...          ...        ...  ...     ...              ...  ...
3478    2289409            1  484-05-61  ...       n                y    1
3479    2289410            1  484-05-62  ...       n                y    1
3482    2289414            1  484-05-65  ...       n                n    1
3483    2289415            1  484-05-66  ...       n                n    1
3484    2289416            1  484-05-67  ...       n                n    1

[2794 rows x 7 columns]
      PatientID  AdmissionID  MedicalNo  ... StayInd StayIndAdmission Flag
4         60576           10  333-91-85  ...       n                n    1
14       421316           10  308-47-57  ...       y                y    1
18       510431           76  341-60-92  ...       y                y    1
21       560219            3  352-67-06  ...       n                y    1
22       575788            2  366-18-73  ...       y                y    1
...         ...          ...        ...  ...     ...              ...  ...
2732    2287269            1  484-04-84  ...       y                y    1
2887    1025910          202  414-76-45  ...       n                n    1
3482    2289414            1  484-05-65  ...       n                n    1
3483    2289415            1  484-05-66  ...       n                n    1
3484    2289416            1  484-05-67  ...       n                n    1

[937 rows x 7 columns]
total row update : 33
      PatientID  AdmissionID  MedicalNo       AdmissionDate StayInd
4         60576           10  333-91-85 2025-03-08 14:14:52       n
60       899198           89  403-83-04 2025-03-08 14:11:24       n
79      1038299            4  415-83-76 2025-03-08 17:01:49       y
92      1129267           83  426-24-68 2025-03-08 14:07:12       n
100     1198891          116  432-89-85 2025-03-08 00:24:26       n
109     1266094           84  439-00-03 2025-03-08 09:51:03       n
140     1450193            6  454-70-96 2025-03-08 16:26:48       n
154     1532621          143  460-69-98 2025-03-08 20:59:06       n
169     1561758            7  462-16-23 2025-03-08 23:16:58       n
241     1791002           45  470-53-18 2025-03-08 18:49:55       n
245     1825894           40  475-70-74 2025-03-08 02:23:02       n
421     2240567            7  483-89-11 2025-03-08 20:30:23       y
431     2243313            5  483-85-58 2025-03-08 08:09:26       n
437     2247436            5  484-40-68 2025-03-08 21:23:55       y
511     2282032            2  485-00-16 2025-03-08 02:48:46       n
530     2289417            2  484-05-68 2025-03-08 23:11:52       y
1142    2290099            1  484-05-81 2025-03-08 10:49:22       y
1168    2290126            1  484-05-82 2025-03-08 11:00:43       n
1595    2290587            1  484-05-87 2025-03-08 15:24:07       n
1623    2290615            1  484-05-91 2025-03-08 17:37:09       n
1626    2290617            1  484-05-93 2025-03-08 18:00:46       n
1634    2290627            1  484-06-01 2025-03-08 18:35:33       n
1638    2290631            1  484-06-03 2025-03-08 20:07:47       y
1641    2290634            1  484-06-06 2025-03-08 21:26:07       n
1644    2290639            1  484-06-09 2025-03-08 21:55:10       n
2403      46670           75  319-76-24 2025-03-06 09:13:57       y
2404      50973          180  333-05-56 2025-03-07 15:13:48       y
2525    1697534           97  471-20-55 2025-03-06 18:52:05       y
2732    2287269            1  484-04-84 2025-03-05 14:44:13       y
2887    1025910          202  414-76-45 2025-03-07 19:47:22       n
3482    2289414            1  484-05-65 2025-03-07 23:20:57       n
3483    2289415            1  484-05-66 2025-03-07 23:22:07       n
3484    2289416            1  484-05-67 2025-03-07 23:31:42       n
total row inserted : 904
      PatientID  AdmissionID  MedicalNo       AdmissionDate StayInd
14       421316           10  308-47-57 2025-03-09 13:08:28       y
18       510431           76  341-60-92 2025-03-09 09:10:01       y
21       560219            3  352-67-06 2025-03-09 09:22:34       n
22       575788            2  366-18-73 2025-03-09 00:36:57       y
26       595246           69  354-62-46 2025-03-09 01:57:27       n
...         ...          ...        ...                 ...     ...
2398    2291418            1  484-06-44 2025-03-09 21:06:26       n
2399    2291419            1  484-06-45 2025-03-09 21:19:26       n
2400    2291420            1  484-06-46 2025-03-09 21:21:27       y
2401    2291421            1  484-06-47 2025-03-09 23:24:17       n
2402    2291422            1  484-06-48 2025-03-09 23:37:14       n

[904 rows x 5 columns]
UPDATE t SET t.MedicalNo = s.MedicalNo, t.AdmissionDate = s.AdmissionDate, t.StayInd = s.StayInd, t.StayIndAdmission = s.StayIndAdmission, t.Flag = s.Flag , t.UpdateDateStaging = CONVERT(DATETIME2(0), GETDATE(),120) FROM staging_rscm.TransPatientStay t INNER JOIN (SELECT * from staging_rscm.TransPatientStay_temporary_table) AS s ON t.PatientID = s.PatientID AND t.AdmissionID = s.AdmissionID WHERE t.PatientID = s.PatientID AND t.AdmissionID = s.AdmissionID ;


success update dan insert
17.624996423721313
scheduler tanggal : 2025-03-10 02:50:02.139604
